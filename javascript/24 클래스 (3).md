# 24. 클래스 (3)

## ✔️ 상속에 의한 클래스 확장

프로토타입 기반 상속은 프로토타입 체인을 통해 상속받는 개념이지만,클래스 확장은 **기존 클래스를 상속** 받아 **확장**(`extends`)하여 정의한다. 

### ∙`extends` 키워드

부모-자식 클래스는 인스턴스의 프로토타입 뿐만 아니라 **클래스간의 프로토타입 체인**도 생성하여 **프로토타입 메서드 및 정적 메서드 모두 상속**이 가능하다.

### ⇒ 동적 상속은 무엇일까?

생성자 함수를 상속 받아 클래스 확장도 가능하다. 해당 클래스 뒤에 `extends` 키워드를 붙인다. 

### ∙서브클래스의 `constructor`

`constructor` 생략시 빈 객체가 생성되어 암묵적 정의가 이뤄진다. 

### ⇒ `super` 키워드

수퍼 클래스의 `constructor`를 호출하여 **인스턴스를 생성**하거나 **메서드를 호출**한다. 반드시 내부에 프로퍼티를 추가해야 한다.

**✔️ 주의할 점**

1. **서브 클래스에서만 호출**이 가능.
2. constructor 사용시 super()를 반드시 호출해야 한다. 생략시 암묵적으로 정의되기 때문이다.
3. super() 호출 전에 this 참조 불가.

**✔️ 참조할 때**

1. 메서드 내에서 `super()` 호출시 **수퍼클래스 메서드 호출**이 가능하다. 수퍼 클래스의 **prototype** 프로퍼티에 바인딩 된 **프로토타입 참조**도 가능. 
2. **정적 메서드 내의** `super()`는 **수퍼클래스의 정적 메서드**를 가리킨다.

### ∙상속 클래스는 인스턴스를 어떻게 생성할까?

수퍼클래스와 서브클래스의 협력으로 인스턴스를 생성할 수 있다. **수퍼클래스**와 **서브클래스**는 내부슬롯의 값이 각각 **base**, **derived**로 나뉘어 동작을 구분한다. 

- **생성 과정**
    
    **서브 클래스 → 수퍼 클래스 → 서브 클래스 → 반환**
    
    서브클래스의 constructor 내부의 super()를 호출하여 수퍼클래스에게 인스턴스 생성을 위임 → 수퍼클래스에서 빈 객체인 인스턴스를 생성하며 this(생성할 인스턴스를 가리킴)를 바인딩. 단, new.target은 서브클래스를 가리키며 생성할 인스턴스의 프로토타입은 서브클래스 prototype 프로퍼티가 가리키는 프로토타입을 가리키게 된다. → 수퍼클래스의 constructor 실행으로 this에 바인딩 된 인스턴스를 초기화하고, 프로퍼티 추가 및 초기값으로 초기화 처리를 한다. → 서브클래스 constructor로 복귀 후 super()가 반환한 인스턴스(수퍼클래스가 생성한)가 this에 바인딩 처리 된다. → 서브클래스 내에서 인스턴스 초기화 → 클래스 처리 완료 후 인스턴스가 바인딩 된 this 최종 반환. 
    
1. **서브클래스**의 경우 **수퍼클래스에게 인스턴스 생성을 위임**하기 때문에 서브클래스의 **`constructor` 내부의 `super()`를 호출**한다.
2. 수퍼클래스에서 빈 객체(인스턴스)를 생성하고 this를 바인딩하며, 생성할 인스턴스를 가리키게 된다. ⇒ **수퍼클래스가 인스턴스를 생성하지만,** new 연산자와 서브클래스가 호출 되어 `**new.target`은 서브클래스를 가리**킨다. 
    
    따라서 생성된 **인스턴스의 프로토타입**은 **서브클래스의 prototype 프로퍼티가 가리키는 객체**(`SubClass.prototype`)가 된다.
    
    ⇒ 인스턴스 생성은 수퍼클래스, 생성된 인스턴스의 프로토타입은 서브클래스의 프로토타입을 가리킨다.
    
3. **수퍼클래스**의 `constructor`의 실행으로 this에 바인딩 된 **인스턴스를 초기화**한다. 인스턴스에 **프로퍼티 추가** 및 전달받은 **초기값으로 초기화** 한다. 
4. **서브클래스** `constructor`로 복귀 후 `super()`가 반환한 인스턴스(수퍼 클래스가 생성한)가 this에 바인딩 된다. ⇒ `super()`가 반환한 인스턴스를 this에 바인딩하여 그대로 사용한다. 
5. 서브클래스 내에서 인스턴스 초기화가 실행된다.
6. 클래스 처리 완료 후 인스턴스가 바인딩 된 this를 반환. 

### ∙표준 빌트인 생성자 함수 확장

표준 빌트인 객체도 `extends` 키워드를 통해 확장이 가능하다. 동일한 클래스의 인스턴스 반환시 메서드와 메서드 체이닝이 가능해진다.